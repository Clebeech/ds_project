# 数据库大作业

1. **832工程：**中国人民大学应用经济学院联合新闻学院于2021年发起，组织大批师生深入全国832个原国家级贫困县，通过访谈当地领导和脱贫攻坚亲历者，以口述史方式记录研究中国脱贫攻坚历程，旨在提炼中国脱贫攻坚经验，为全球减贫提供中国方案。

2. **核心命题**：围绕“832工程” 设计并实现一个有具体服务目标的数据库应用系统。

3. **具体任务：**

   - 任务一：收集数据、进行应用场景和用户设计

     设计场景和用户角色：依据收集到的数据设计应用场景，如该系统的用户包括哪些角色，分别完成哪些数据操作和分析，这些功能如何对应到 SQL 操作上。

   - 任务二：数据库设计

     小组成员根据收集的数据，设计完成ER图和数据库模式的设计要求理解并设计合理的数据库模式，实体关系来存放 832 工程相关的数据。具体要求上，从规范化程度和应用开发的方便性综合评判最终选择的数据库模式；最终需要得到E-R图，并且其形式需要与教材上介绍的E-R模型尽量接近；实体和表的数量尽量丰富，至少要 5 个。

   - 任务三：实现功能，响应用户请求

     采用传统动态网站开发方式，如Python Django，Java JSP，PHP等，完成一个基于 832 工程的数据库应用系统开发，完成不同角色下的不同功能

4. 我们的思路：

   - 具体服务目标：通过手机整理县域访谈信息，结合县域宏观经济、农业结构、自然地理等数据，为政府扶贫政策分析师提供脱贫案例库支持。
   - 总体思路：五块表。
     - 县行政区划表：主键是县域行政区划代码（6位数字）。
     - 县经济表：包含县的农业结构、农产品产量、财政收支、居民收入等。
     - 县自然表：包含县的地形起伏度、平均降水量等。
     - 调研员表：包含调研员id，县id，所属队伍id。
     - 访谈内容表：包含调研员id、被访谈县id、访谈记录等。
    
[16 tools called]

## 数据摸底结果

- **目录清单**：`data/各县基本数据/` 现有 7 张单表化 Excel（均为 `Sheet1`），覆盖人口、交通、财政、收入、GDP、金融、综合指标；`data/archive/` 另存农业产量/播种面积、地形起伏度、降水、贫困县名单等历史或备用资料，部分（如播种面积）为宽表版本；`data/访谈记录.xlsx`、`data/调研员表.xlsx`、`data/对应县.xlsx` 构成业务主数据。
- **字段结构摘要**：
  - `data/各县基本数据/综合数据.xlsx`：包含 40+ 指标（行政区面积→社会福利），县级代码 `CountyCode` 可作为与其他表的主键；字段说明已记录在 `data/各县基本数据/各表表头说明.docx`。
  - 其余县情表（人口、财政收支、交通运输等）字段统一以 `SgnYear/AreaID/CountyCode` 等命名，便于后续整合。
  - `data/archive/中国各县域逐月平均降水量统计.xlsx` 为超宽时间序列（1901-01 至 2024-12），需按需透视后再入库；`全国832个国家贫困县历年摘帽名单.xlsx` 实为文本化公告，需人工抽取。
- **数据量与缺失情况**：
  - `data/访谈记录.xlsx`：有效行 127，`访谈记录id/调研人id/县id` 各有 4 行缺失（原因是访谈正文被拆出多行）；访谈时间存为 Excel 序列号（如 `45092`），需统一转日期。
  - `data/调研员表.xlsx`：行数 30，但首列为序号，`调研人id` 实际出现在“姓名”列（值为 `DY2021****`），列头与内容错位需修正；日期字段亦为序列号。
  - `data/对应县.xlsx` 当前为空表，可作为后续访谈-县域映射模板。
  - 县情表普遍字段齐全，待后续统计缺失值；`城乡居民收入.xlsx` 在说明中已标注“缺的值很多”，清洗时需重点关注。
- **跨表映射检测**：
  - 访谈中仅出现 24 个不同县码，而综合县情表含 823 个 `CountyCode`，大部分访谈尚未关联县码；结合 `data/archive/全国832个国家级贫困县名单.xlsx` 可校验覆盖面。
  - 访谈表中的 `DY2021****` 编号在“调研员表”中存在，但需改以“姓名”列作为外键；同时建议将访谈表缺失的 `调研人id/县id` 通过回填或拆分记录解决。
- **质量提示**：
  - 多个 Excel 的时间字段、数值字段默认以文本形式存储（字符串或科学计数法），后续导入前应批量转 `float64` 再处理缺失/异常。
  - `data/archive` 中同主题（如播种面积）存在 `.xlsx` 与 `.dta` 两种格式，需选定权威版本，避免重复入库。
  - `访谈记录.xlsx` 中多行文本含 `\xa0` 等不可见字符，导入前需清理。
- **数据字典草稿思路**：
  - 以 `CountyCode` 为核心主键；记录每张表字段中文含义、单位（参照 `各表表头说明.docx`）、类型、缺失率与约束建议。
  - 业务表需额外说明访谈实体（受访人、访谈对象）与调研员的实体定义及主外键关系。

测试尚未执行。建议下一步在 `Plan` 中推进 ER 建模前，整理字段/单位对照表并确定优先入库的数据源。